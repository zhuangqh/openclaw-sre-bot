; ================================
; Supervisor Configuration
; ================================

[unix_http_server]
file=/var/run/supervisor.sock   ; path to your socket file
chmod=0700                       ; socket file mode (default 0700)

[supervisord]
nodaemon=true                   ; run in foreground (required for containers)
user=root                       ; run as root
pidfile=/var/run/supervisord.pid ; pidfile location
logfile=/var/log/supervisor/supervisord.log ; main log file
logfile_maxbytes=50MB           ; max main logfile bytes before rotation
logfile_backups=10              ; number of logfile backups
loglevel=info                   ; log level (debug,info,warn,error,critical)
childlogdir=/var/log/supervisor ; where child log files will be stored

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock ; use a unix:// URL for a unix socket

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

; ================================
; Program Definitions
; ================================

[program:kasm_profile]
command=/bin/bash -c "/dockerstartup/kasm_default_profile.sh /dockerstartup/vnc_startup.sh /dockerstartup/kasm_startup.sh --wait"
user=kasm-user
priority=1
autostart=true
autorestart=false               ; profile setup only runs once
startsecs=0                     ; consider started immediately
exitcodes=0                     ; expected exit code
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:openclaw]
command=/bin/bash -c "openclaw doctor --fix && openclaw gateway --allow-unconfigured"
user=kasm-user
priority=22
autostart=true
autorestart=true                ; restart on unexpected exit
startsecs=10                    ; wait 10 seconds before considering started
stopwaitsecs=30                 ; wait 30 seconds for graceful shutdown
stopsignal=TERM                 ; signal to send on stop
exitcodes=0                     ; expected exit codes for autorestart
stdout_logfile=/home/kasm-user/openclaw.log
stdout_logfile_maxbytes=0
stderr_logfile=/home/kasm-user/openclaw.log
stderr_logfile_maxbytes=0
